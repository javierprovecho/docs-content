+++
title = "Execute a command in a component instance"
description = "This is the reference page for the 'swarm exec' command, which allows you to call a command inside an instance of a component or open a shell."
date = "2015-05-21"
type = "page"
categories = ["Reference", "Swarm CLI Commands"]
tags = ["swarm exec"]
weight = 92
+++

# `swarm exec`: Run an Instance Command 

With the `swarm exec` command, you can start a new process inside a running instance, which can include running scripts or establishing an interactive shell. Any command you run must be supported by the underlying container image for the instance.

## Synopsis

```nohighlight
$ swarm exec <instance-id> [-d|--detach] [--] [<command>]
```

* The `instance-id` argument specifies an instance of a running application component.

* When using the `-d` or `--detach` flags, the CLI will detach from the running process. The use of the detach flag is optional.

* The `command` argument specifies the command to be executed on the target instance. If no command argument is given, the command `/bin/sh` is used to open a shell on the instance's container.

* The option separator `--` must be used when a `command` argument contains additional flags, e. g. `ls -la`.

**Note:** Use the [`swarm status`](../status/) command to list all instances of an application. You may use partial IDs, omitting characters from the end, as long as the partial ID is unique within your environment.

## Examples

Here are a few examples you can try out on your instances.  Let's start by getting the instance IDs with `swarm status`, assuming that we have an application called `helloworld`:

```nohighlight
$ swarm status helloworld
App helloworld is up

service             component             image                  instanceid    created              status
helloworld-service  helloworld-component  giantswarm/helloworld  hvuos3dhlgha  2015-05-12 14:50:35  up
```

### Shell Into the Instance

If the instance is running an image which has support for running a shell, you should be able to do the following:

```nohighlight
$ swarm exec hvuos3dhlgha /bin/sh
```

Here's a simple example of shelling into the Giant Swarm [helloworld](https://github.com/giantswarm/helloworld) example and getting a directory listing and process list:

```nohighlight
$ swarm exec hvuos3dhlgha /bin/sh

BusyBox v1.21.1 (Ubuntu 1:1.21.0-1ubuntu1) built-in shell (ash)
Enter 'help' for a list of built-in commands.

~ # ls
bin    dev    etc    lib    lib64  proc   sbin   sys    tmp    usr
~ # ps -a
PID   USER     COMMAND
    1 root     helloworld
   42 root     /bin/sh
   49 root     {busybox} ps -a
```

The `swarm exec` command uses `/bin/sh` by default. This results in a simple way to quickly check in on an instance:

```nohighlight
$ swarm exec hvuos3dhlgha
```

Quitting a shell session usually requires the `exit` command or hitting `Ctrl + D`.

### Listing Instance Directories

Listing the contents of the default path in an instance with ID `hvuos3dhlgha` can be done by doing the following:

```nohighlight
$ swarm exec hvuos3dhlgha ls
```

*Note: The use of `ls` requires the `ls` binary be available on the instance. If it fails, try shelling into the instance to debug!*

### Using Parameters with Commands

Using arguments with a `command` requires the use of the option separator `--` to keep the Swarm CLI from parsing the command's arguments for itself.

Running `grep -r foo /etc` on an instance with ID `hvuos3dhlgha` can done by doing the following:

```nohighlight
$ swarm exec hvuos3dhlgha -- grep -r foo /etc
```

*Note: STDOUT and STDERR for the command will be outputted to your terminal. To detach a blocking process, use the `-d` or `--detach` flag.*

### Long Running Processes

If you need to execute a long running process, use the afore mention `-d` or `--detach` flags:

```nohighlight
$ swarm exec hvuos3dhlgha -d /path/to/tedious-task
```

## Considerations and Limitations

Best practices suggest containers should only run a single process. It is required that this process be kicked off using the `ENTRYPOINT` or `CMD` directives in the container's Dockerfile.

Giant Swarm's service assumes a container should be restarted when the main process in the container dies. Extra processes started outside the Dockerfile directives, such as those run by a `swarm exec`, are not moninitored by Giant Swarm's system. This includes logs or console output generated by these extra processes.

To ensure a process is always running on Giant Swarm, you should ensure the main process in started from the Dockerfile.

The `swarm exec` function is best suited for short-running processes, which could include jobs like importing data into a database, manually creating a backup of a directory, or interactively debugging a system while it's running.

Remember, use your best judgement when adding extra processes to a container. With microservices, less is always more!

Also be aware of this limitation in the current implementation: The return values of executed commands and their exit codes are not returned by `swarm exec`. This fact makes it difficult to programatically detect whether or not the command exists on the instance, and whether it successfully ran and exited, or not.

## Further Reading

* [Getting an applications's status](/reference/cli/status/) and listing instance IDs available in an application
* [Getting statistics of an application, service, component or instance](/reference/cli/stats/)
